
<!DOCTYPE html>
<html>
<head>
	<script type="text/javascript" src="js/jquery.min.js"></script>
</head>    
<body>
    <div>

  <button id='request'>
    Request Camera
  </button>
  <button id='start'>
    Start Recording
  </button>
  <button id='pause'>
    Pause
  </button>
  <button id='resume'>
    Resume
  </button>
  <button id='stop'>
    Stop Recording
  </button>
  <button id='upload'>
    Upload
  </button>
  <ul id='ul'>
    Downloads List:
  </ul>

</div>
<video id='video' autoplay></video>
</body>
<script type="text/javascript">
 
 
window.onload = function() {
		var video, reqBtn, startBtn, stopBtn, ul, stream, recorder;
		video = document.getElementById('video');
		reqBtn = document.getElementById('request');
		startBtn = document.getElementById('start');
		stopBtn = document.getElementById('stop');
		
		pauseBtn = document.getElementById('pause');
		resumeBtn = document.getElementById('resume');
		ul = document.getElementById('ul');
		reqBtn.onclick = requestVideo;
		startBtn.onclick = startRecording;
		stopBtn.onclick = stopRecording;
		
		pauseBtn.onclick = pauseRecording;
		resumeBtn.onclick = resumeRecording
		startBtn.disabled = true;
		ul.style.display = 'none';
		stopBtn.disabled = true;
		
		function requestVideo()
		{
		  navigator.mediaDevices.getUserMedia({
		      video: true,
		      audio: true
		    })
		    .then(stm => {
		      stream = stm;
		      reqBtn.style.display = 'none';
		      startBtn.removeAttribute('disabled');
		      video.src = URL.createObjectURL(stream);
		    }).catch(e => console.error(e));
		}
		
		function startRecording() 
		{
			navigator.mediaDevices.getUserMedia({
			      video: true,
			      audio: true
			    })
			    .then(stm => {
			      stream = stm;
			      reqBtn.style.display = 'none';
			      video.src = URL.createObjectURL(stream);
			    }).catch(e => console.error(e));
		  recorder = new MediaRecorder(stream, { mimeType: 'video/webm' });
		  recorder.start();
		  stopBtn.removeAttribute('disabled');
		  startBtn.disabled = true;
		}
		function pauseRecording() 
		{
			recorder.pause();	
		}
		function resumeRecording() 
		{
			recorder.resume()
		}
		
		function stopRecording() 
		{
		  recorder.ondataavailable = e => {
		    ul.style.display = 'block';
		    var a = document.createElement('a'),
		      li = document.createElement('li');
		    a.download = ['video_', (new Date() + '').slice(4, 28), '.webm'].join('');
		    a.href = URL.createObjectURL(e.data);
		    $(video).attr('src',URL.createObjectURL(e.data));
		    $(video).attr('controls','');
		    a.textContent = a.download;
		    li.appendChild(a);
		    ul.appendChild(li);
		  };
		  recorder.stop();
		  startBtn.removeAttribute('disabled');
		  stopBtn.disabled = true;
		}
		
		$('#upload').click(function(){
			
			console.log($(video).attr('src'));
			recorder.ondataavailable = e => {
			     console.log(e.data);
			  };
			  recorder.stop();
		});

}
</script>

</html>